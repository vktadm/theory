## –†–∞–∑–¥–µ–ª—ã

- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**
- **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞)**
- **Middleware**
- **–§–∏–ª—å—Ç—Ä—ã**
- **–•—ç–Ω–¥–ª–µ—Ä—ã**
- **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**
- **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ë–î**
- **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –≤–Ω–µ—à–Ω–∏–º–∏ API**
- **–õ–µ–∫—Å–∏–∫–æ–Ω –±–æ—Ç–∞**
- **–ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã**
- **–°–æ—Å—Ç–æ—è–Ω–∏—è**
- **–¢–µ—Å—Ç—ã**
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫**
- **–£—Ç–∏–ª–∏—Ç—ã**
## –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```python
import asyncio
import logging
from aiogram import Bot, Dispatcher, types
from aiogram.filters.command import Command

# –í–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤–∞–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
logging.basicConfig(level=logging.INFO)
# –û–±—ä–µ–∫—Ç –±–æ—Ç–∞
bot = Bot(token="12345678:AaBbCcDdEeFfGgHh")
# –î–∏—Å–ø–µ—Ç—á–µ—Ä
dp = Dispatcher()

# –•—ç–Ω–¥–ª–µ—Ä –Ω–∞ –∫–æ–º–∞–Ω–¥—É /start
@dp.message(Command("start"))
async def cmd_start(message: types.Message):
    await message.answer("Hello!")

# –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–ª–ª–∏–Ω–≥–∞ –Ω–æ–≤—ã—Ö –∞–ø–¥–µ–π—Ç–æ–≤
async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
```

## –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
```python
@dp.message(Command("answer"))
async def cmd_answer(message: types.Message):
    await message.answer("–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –æ—Ç–≤–µ—Ç")


@dp.message(Command("reply"))
async def cmd_reply(message: types.Message):
    await message.reply('–≠—Ç–æ –æ—Ç–≤–µ—Ç —Å "–æ—Ç–≤–µ—Ç–æ–º"')
```

## –§–∏–ª—å—Ç—Ä—ã

```python
def my_start_filter(message: Message) -> bool:  
    return message.text == '/start'


@dp.message(my_start_filter)  
async def process_start_command(message: Message):  
    await message.answer(text='–≠—Ç–æ –∫–æ–º–∞–Ω–¥–∞ /start')
    
# –ò–ª–∏ —Å lambda
@dp.message(lambda msg: msg.text == '/start')  
async def process_start_command(message: Message):  
    await message.answer(text='–≠—Ç–æ –∫–æ–º–∞–Ω–¥–∞ /start')
```

##### ContentType

[‚ùóÔ∏è–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞](https://docs.aiogram.dev/en/dev-3.x/api/enums/content_type.html#module-aiogram.enums.content_type)

```python
ContentType.AUDIO == 'audio'                                # True
ContentType.TEXT == 'text'                                  # True
ContentType.PHOTO == 'photo'                                # True
ContentType.STICKER == 'sticker'                            # True
ContentType.CONTACT == 'contact'                            # True
ContentType.LOCATION == 'location'                          # True
ContentType.POLL == 'poll'                                  # True
ContentType.SUCCESSFUL_PAYMENT == 'successful_payment'      # True
ContentType.VOICE == 'voice'                                # True
ContentType.WEB_APP_DATA == 'web_app_data'                  # True
```

```python
# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ "photo"
@dp.message(F.content_type == ContentType.PHOTO)
async def process_send_photo(message: Message):
    await message.answer(text='–í—ã –ø—Ä–∏—Å–ª–∞–ª–∏ —Ñ–æ—Ç–æ')


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ "photo"
@dp.message(F.content_type == 'photo')
async def process_send_photo(message: Message):
    await message.answer(text='–í—ã –ø—Ä–∏—Å–ª–∞–ª–∏ —Ñ–æ—Ç–æ')


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ "photo"
@dp.message(F.photo)
async def process_send_photo(message: Message):
    await message.answer(text='–í—ã –ø—Ä–∏—Å–ª–∞–ª–∏ —Ñ–æ—Ç–æ')
```

```python
# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ "voice", "video" –∏–ª–∏ "text"
@dp.message(F.content_type.in_({'voice', 'video', 'text'}))
async def process_send_vovite(message: Message):
    await message.answer(text='–í—ã –ø—Ä–∏—Å–ª–∞–ª–∏ –≤–æ–π—Å, –≤–∏–¥–µ–æ –∏–ª–∏ —Ç–µ–∫—Å—Ç')


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ "voice", "video" –∏–ª–∏ "text"
@dp.message(F.content_type.in_({ContentType.VOICE,
                                ContentType.VIDEO,
                                ContentType.TEXT}))
async def process_send_vovite(message: Message):
    await message.answer(text='–í—ã –ø—Ä–∏—Å–ª–∞–ª–∏ –≤–æ–π—Å, –≤–∏–¥–µ–æ –∏–ª–∏ —Ç–µ–∫—Å—Ç')
```

##### –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã [‚ùóÔ∏è–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º](https://docs.aiogram.dev/en/dev-3.x/dispatcher/filters/index.html#builtin-filters)

##### –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã

```python
from aiogram import F
F.photo                                    # –§–∏–ª—å—Ç—Ä –¥–ª—è —Ñ–æ—Ç–æ
F.voice                                    # –§–∏–ª—å—Ç—Ä –¥–ª—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
F.content_type.in_({ContentType.PHOTO,
                    ContentType.VOICE,
                    ContentType.VIDEO})    # –§–∏–ª—å—Ç—Ä –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
F.text == '–ø—Ä–∏–≤–µ—Ç'                         # –§–∏–ª—å—Ç—Ä –Ω–∞ –ø–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
F.text.startswith('–ø—Ä–∏–≤–µ—Ç')                # –§–∏–ª—å—Ç—Ä –Ω–∞ —Ç–æ, —á—Ç–æ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å '–ø—Ä–∏–≤–µ—Ç'
~F.text.endswith('bot')                    # –ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–∞
```

**–ü—Ä–∏–º–µ—Ä—ã**

```python
# –§–∏–ª—å—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–ø–¥–µ–π—Ç—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å ID =¬†173901673
lambda message: message.from_user.id == 173901673
F.from_user.id == 173901673

# –§–∏–ª—å—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–ø–¥–µ–π—Ç—ã –æ—Ç –∞–¥–º–∏–Ω–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞¬†193905674,¬†173901673,¬†144941561
lambda message: message.from_user.id in {193905674,¬†173901673,¬†144941561}
F.from_user.id.in_({193905674,¬†173901673,¬†144941561})

# –§–∏–ª—å—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –∞–ø–¥–µ–π—Ç—ã —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ç–∏–ø–∞, –∫—Ä–æ–º–µ —Ç–µ—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å–æ —Å–ª–æ–≤–∞ "–ü—Ä–∏–≤–µ—Ç"
lambda message: not message.text.startswith('–ü—Ä–∏–≤–µ—Ç')
~F.text.startswith('–ü—Ä–∏–≤–µ—Ç')

# –§–∏–ª—å—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –∞–ø–¥–µ–π—Ç—ã –ª—é–±–æ–≥–æ —Ç–∏–ø–∞, –∫—Ä–æ–º–µ —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –∞—É–¥–∏–æ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
lambda message: not message.content_type in {ContentType.PHOTO, ContentType.VIDEO, ContentType.AUDIO, ContentType.DOCUMENT}
~F.content_type.in_({ContentType.PHOTO, ContentType.VIDEO, ContentType.AUDIO, ContentType.DOCUMENT})
```

##### –ú–∞–≥–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ __call__

```python
class MyClass:
    def __init__(self) -> None:
        pass

    def __call__(self) -> str:
        return '–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞'


my_class_1 = MyClass()
my_class_2 = MyClass()

print(my_class_1()) # –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞
print(my_class_2()) # –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞
```

##### –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã

```python
from aiogram.filters import BaseFilter

# –≠—Ç–æ —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –±–æ—Ç–∞
admin_ids: list[int] = [173901673, 178876776, 197177271]

class IsAdmin(BaseFilter):
    def __init__(self, admin_ids: list[int]) -> None:
        self.admin_ids = admin_ids

    async def __call__(self, message: Message) -> bool:
        return message.from_user.id in self.admin_ids
```

**‚ùóÔ∏è–í–∞—à ID –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å –∏–∑ –ª—é–±–æ–≥–æ –∞–ø–¥–µ–π—Ç–∞ –æ—Ç –≤–∞—Å –≤–∞—à–µ–º—É –±–æ—Ç—É - `print(message.from_user.id)`**

##### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤

1. –ï—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã —É–∫–∞–∑–∞—Ç—å —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, —Ç–æ –º–µ–∂–¥—É –Ω–∏–º–∏ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è —É—Å–ª–æ–≤–∏–µ "–ò"
```python
@dp.message(F.photo, F.from_user.id == 173901673) # True and True == True
@dp.message(F.photo, F.voice) # True and False == False
```
2. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —Ñ–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞–ª–∏ –ø–æ —É—Å–ª–æ–≤–∏—é "–ò–õ–ò", —Ç–æ –µ—Å—Ç—å —Ö—ç–Ω–¥–ª–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª –±—ã —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ñ–∏–ª—å—Ç—Ä –∏–∑ —Ü–µ–ø–æ—á–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–ª¬†`True`¬†- –Ω—É–∂–Ω–æ –¥–µ–∫–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ö—ç–Ω–¥–ª–µ—Ä —Å—Ç–æ–ª—å–∫–æ —Ä–∞–∑, —Å–∫–æ–ª—å–∫–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ —Ü–µ–ø–æ—á–∫–µ.
```python
@dp.message(F.content_type == ContentType.VIDEO) @dp.message(F.text.lower().startswith('–ø—Ä–∏–≤–µ—Ç'))
```
3. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞–∫¬†`~`¬†–ø–µ—Ä–µ–¥ —Ñ–∏–ª—å—Ç—Ä–æ–º
```python
@dp.message(~F.text.startswith('–ø—Ä–∏–≤–µ—Ç'))
```
4. –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–±–∏—Ç–æ–≤–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ò/–ò–õ–ò (`&`¬†/¬†`|`)
```python
@dp.message((F.text | F.photo) & F.from_user.id == 173901673)
```
5. –í –∫–∞—á–µ—Å—Ç–≤–µ —Å–ø–æ—Å–æ–±–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏¬†`and_f()`,¬†`or_f()`,¬†`invert_f()`, –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –∏–∑¬†`aiogram.filters`
```python
from aiogram.filters import and_f

# ...

@dp.message(and_f(F.text.endswith('bot'), F.from_user.id == 173901673))
```

## –ê–±—Å–æ–ª—é—Ç–Ω—ã–π –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç

–í Python —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã.

- **–ê–±—Å–æ–ª—é—Ç–Ω—ã–π –∏–º–ø–æ—Ä—Ç:**¬†–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –º–æ–¥—É–ª—é, –Ω–∞—á–∏–Ω–∞—è –æ—Ç –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.
- **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç:**¬†–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –º–æ–¥—É–ª—é, –Ω–∞—á–∏–Ω–∞—è –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –º–æ–¥—É–ª—è.¬†–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤: —è–≤–Ω—ã–π –∏ –Ω–µ—è–≤–Ω—ã–π (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ Python 3).¬†–í –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–º –∏–º–ø–æ—Ä—Ç–µ —Å –ø–æ–º–æ—â—å—é —Ç–æ—á–µ–∫ –º–æ–∂–Ω–æ –¥–æ–π—Ç–∏ —Ç–æ–ª—å–∫–æ –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Å–∫—Ä–∏–ø—Ç.

–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –∏ —Å–∞–º–æ–µ –æ–ø—Ä–∞–≤–¥–∞–Ω–Ω–æ–µ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ - –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–æ–≤¬†`__init__.py`.

–ú–æ–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –æ–±—ä–µ–∫—Ç—ã —Å –ø–æ–º–æ—â—å—é –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π¬†`__all__`.
##### –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞—Å–ø–µ–∫—Ç—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏:

1. –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –æ—Ç—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è¬†–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π¬†—Ñ–∞–π–ª, —Ç–æ –µ—Å—Ç—å —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∏–º–µ–µ—Ç –∏–º—è¬†`__main__`.
    
2. –í –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–µ - —Ç–æ—á–∫–µ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–æ–µ–∫—Ç, –Ω–µ –º–æ–∂–µ—Ç, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –±—ã—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ - —Ç–æ–ª—å–∫–æ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ.
    
3. –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏, –±–µ–∑ "—Ö–∞–∫–æ–≤" –∏ "–∫–æ—Å—Ç—ã–ª–µ–π" –Ω–µ–ª—å–∑—è –ø–æ–¥–Ω–∏–º–∞—Ç—å—Å—è –Ω–∞ —É—Ä–æ–≤–µ–Ω—å, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª - –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É.
    
4. –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –æ–ø—Ä–∞–≤–¥–∞–Ω—ã –≤–Ω—É—Ç—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤, –Ω–æ –Ω–∞–¥–µ–∂–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã, –µ—Å–ª–∏ –≤—ã –ø–æ–∫–∞ –Ω–µ "–Ω–∞–±–∏–ª–∏ —Ä—É–∫—É".
    
5. –ß—Ç–æ–±—ã –º–æ–¥—É–ª–∏ –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–∞–∫–µ—Ç–æ–≤ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –ø–∞–∫–µ—Ç–∞¬†`__init__.py`, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–ø–∏—à–∏—Ç–µ –∏–º–ø–æ—Ä—Ç—ã —ç—Ç–∏—Ö –º–æ–¥—É–ª–µ–π.
    
6. –ò–º–ø–æ—Ä—Ç—ã —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π –æ–ø—Ä–∞–≤–¥–∞–Ω—ã, –∫–æ–≥–¥–∞ –Ω–∞–¥–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫¬†–æ–±—ä–µ–∫—Ç–∞–º –º–æ–¥—É–ª–µ–π, –ø–æ–¥–ø–∞–∫–µ—Ç–æ–≤, –º–æ–¥—É–ª–µ–π –≤ –ø–æ–¥–ø–∞–∫–µ—Ç–∞—Ö –∏ —Ç.–¥. –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–∞–∫–µ—Ç–∞.
    
7. –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–æ, —á—Ç–æ –º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ –º–æ–¥—É–ª—è, –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∏–º–ø–æ—Ä—Ç–∞ —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π, –º–æ–∂–Ω–æ –ª–∏–±–æ –Ω–∞–∑—ã–≤–∞—è —Å–∫—Ä—ã—Ç—ã–µ –æ–±—ä–µ–∫—Ç—ã —Å –Ω–∏–∂–Ω–µ–≥–æ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è, –ª–∏–±–æ –ø–µ—Ä–µ—á–∏—Å–ª—è—è –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π¬†`__all__`.
    
8. –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–π –∏–º–µ–Ω –æ–±—ä–µ–∫—Ç–æ–≤ - –ø–æ–º–Ω–∏—Ç–µ –æ –ø–æ—Ä—è–¥–∫–µ –ø–æ–∏—Å–∫–∞ –º–æ–¥—É–ª–µ–π –∏ –ø–∞–∫–µ—Ç–æ–≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–æ–º. –ß—Ç–æ –ø–µ—Ä–≤–æ–µ –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω–æ, —Ç–æ –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è.
    
    - –°–Ω–∞—á–∞–ª–∞ –∏–¥–µ—Ç –ø–æ–∏—Å–∫ –º–æ–¥—É–ª–µ–π –∏ –ø–∞–∫–µ—Ç–æ–≤ –≤–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª—è—Ö (`builtin_module_names`)
        
    - –ó–∞—Ç–µ–º –ø–æ–∏—Å–∫ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —á—Ç–æ –∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª)
        
    - –ó–∞—Ç–µ–º –∏–¥–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π¬†`PYTHONPATH`
        
    - –î–∞–ª–µ–µ –∏–¥–µ—Ç –ø–æ–∏—Å–∫ –≤ –º–æ–¥—É–ª—è—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`stdlib_module_names`)
        
    - –í —Å–∞–º—É—é –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—á–µ—Ä–µ–¥—å –ø–æ–∏—Å–∫ –º–æ–¥—É–ª–µ–π –∏ –ø–∞–∫–µ—Ç–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ä–µ–¥–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤ –ø–∞–ø–∫–µ¬†`site-packages`
        
9. –ù–µ –¥–æ–ø—É—Å–∫–∞–π—Ç–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ - –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É.

## –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
**`bot.py`**
```python
import asyncio
from aiogram import Bot, Dispatcher


# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
async def main():
    bot = Bot(token="TOKEN")
    dp = Dispatcher()

    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞ –∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –≤—Å–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –≤—Ö–æ–¥—è—â–∏–µ
    # –î–∞, —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –¥–∞–∂–µ –µ—Å–ª–∏ —É –≤–∞—Å –ø–æ–ª–ª–∏–Ω–≥
    await bot.delete_webhook(drop_pending_updates=True)
    await dp.start_polling(bot)


if __name__ == "__main__":
    asyncio.run(main())
```

## –†–æ—É—Ç–µ—Ä—ã

### main.py

```python
import asyncio

from aiogram import Bot, Dispatcher
from config_data.config import Config, load_config
from handlers import other_handlers, user_handlers


# –§—É–Ω–∫—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
async def main():

    # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é config
    config: Config = load_config()
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–æ—Ç –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä
    bot = Bot(token=config.tg_bot.token)
    dp = Dispatcher()

    # –†–µ–≥–∏—Å—Ç—Ä–∏—É–µ–º —Ä–æ—É—Ç–µ—Ä—ã –≤ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–µ
    dp.include_router(user_handlers.router)
    dp.include_router(other_handlers.router)

    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∞–∫–æ–ø–∏–≤—à–∏–µ—Å—è –∞–ø–¥–µ–π—Ç—ã –∏ –∑–∞–ø—É—Å–∫–∞–µ–º polling
    await bot.delete_webhook(drop_pending_updates=True)
    await dp.start_polling(bot)


asyncio.run(main())
```

### user_handlers.py

```python
from aiogram import Router
from aiogram.filters import Command, CommandStart
from aiogram.types import Message
from lexicon.lexicon import LEXICON_RU

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–æ—É—Ç–µ—Ä —É—Ä–æ–≤–Ω—è –º–æ–¥—É–ª—è
router = Router()


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /start
@router.message(CommandStart())
async def process_start_command(message: Message):
    await message.answer(text=LEXICON_RU['/start'])


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /help
@router.message(Command(commands='help'))
async def process_help_command(message: Message):
    await message.answer(text=LEXICON_RU['/help'])
```

### other_handlers.py

```python
from aiogram import Router
from aiogram.types import Message
from lexicon.lexicon import LEXICON_RU

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–æ—É—Ç–µ—Ä —É—Ä–æ–≤–Ω—è –º–æ–¥—É–ª—è
router = Router()


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –ª—é–±—ã–µ –≤–∞—à–∏ —Å–æ–æ–±—â–µ–Ω–∏—è,
# –∫—Ä–æ–º–µ –∫–æ–º–∞–Ω–¥ "/start" –∏ "/help"
@router.message()
async def send_echo(message: Message):
    try:
        await message.send_copy(chat_id=message.chat.id)
    except TypeError:
        await message.reply(text=LEXICON_RU['no_echo'])
```

```python
router.message.filter(KnownUser())


@router.message(filter_1, filter_2)
async def handler_1(message: Message):
    # ...


@router.message(filter_3)
async def handler_2(message: Message):
    # ...


@router.message(filter_4, filter_5)
async def handler_3(message: Message):
    # ...


@router.message(filter_6)
async def handler_4(message: Message):
    # ...
```

## –ö–Ω–æ–ø–∫–∏

–î–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –≤–∏–¥–∞ –∫–Ω–æ–ø–æ–∫: –æ–±—ã—á–Ω—ã–µ (reply) –∏ –∏–Ω–ª–∞–π–Ω (inline).
##### –û–±—ã—á–Ω—ã–µ (reply) –∫–Ω–æ–ø–∫–∏

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±—ã—á–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏ –∏–∑¬†`aiogram.types`¬†–ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∞—Å—Å—ã:

- `ReplyKeyboardMarkup`¬†- –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã ([—Å—Å—ã–ª–∫–∞](https://core.telegram.org/bots/api#replykeyboardmarkup)¬†–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Telegram Bot API)
- `KeyboardButton`¬†- –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã¬†([—Å—Å—ã–ª–∫–∞](https://core.telegram.org/bots/api#keyboardbutton)¬†–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Telegram Bot API)
- `ReplyKeyboardRemove`¬†- –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã¬†([—Å—Å—ã–ª–∫–∞](https://core.telegram.org/bots/api#replykeyboardremove)¬†–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Telegram Bot API)

```python
# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç—ã –∫–Ω–æ–ø–æ–∫
button_1 = KeyboardButton(text='–°–æ–±–∞–∫ ü¶Æ')
button_2 = KeyboardButton(text='–û–≥—É—Ä—Ü–æ–≤ ü•í')

# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, –¥–æ–±–∞–≤–ª—è—è –≤ –Ω–µ–≥–æ –∫–Ω–æ–ø–∫–∏
keyboard = ReplyKeyboardMarkup(
    keyboard=[[button_1, button_2]],
    resize_keyboard=True,
    one_time_keyboard=True
)
```

## KeyboardBuilder ("—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä")

##### –ú–µ—Ç–æ–¥ row()

```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∏–ª–¥–µ—Ä
kb_builder = ReplyKeyboardBuilder()

# –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏
buttons: list[KeyboardButton] = [
    KeyboardButton(text=f'–ö–Ω–æ–ø–∫–∞ {i + 1}') for i in range(10)
]

# –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤ –±–∏–ª–¥–µ—Ä, —É–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ
# –≤ –æ–¥–Ω–æ–º —Ä—è–¥—É –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 4 –∫–Ω–æ–ø–∫–∏
kb_builder.row(*buttons, width=4)


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—É "/start"
# –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ —á–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
@dp.message(CommandStart())
async def process_start_command(message: Message):
    await message.answer(
        text='–í–æ—Ç —Ç–∞–∫–∞—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞',
        reply_markup=kb_builder.as_markup(resize_keyboard=True)
    )
```

–ú–µ—Ç–æ–¥¬†`row`¬†—É –∫–ª–∞—Å—Å–∞¬†`ReplyKeyboardBuilder`¬†–ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞¬†`width`¬†- –∂–µ–ª–∞–µ–º–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–Ω–æ–ø–æ–∫ –≤ —Ä—è–¥—É.
##### –ú–µ—Ç–æ–¥ add()

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –º–µ—Ç–æ–¥–∞¬†`row()`¬†–º–µ—Ç–æ–¥¬†`add()`¬†–¥–æ–±–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫–∏ —Å –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ä—è–¥—É –¥–ª—è –Ω–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫ —É–∂–µ –Ω–µ—Ç –º–µ—Å—Ç–∞. –ü—Ä–∏—á–µ–º, –º–µ—Ç–æ–¥—É¬†`add`¬†–≤—Å–µ —Ä–∞–≤–Ω–æ –∫–∞–∫–æ–π —Ç–∞–º —É –≤–∞—Å –±—ã–ª –ø–∞—Ä–∞–º–µ—Ç—Ä¬†`width`¬†–¥–æ —ç—Ç–æ–≥–æ. –ö–Ω–æ–ø–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –≤ —Ä—è–¥ –ø–æ–∫–∞ –∏—Ö —Ç–∞–º –Ω–µ —Å—Ç–∞–Ω–µ—Ç 8 –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –Ω–∞—á–Ω—É—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å –Ω–æ–≤—ã–π —Ä—è–¥. –¢–æ–∂–µ –¥–æ 8 —à—Ç—É–∫.

```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∏–ª–¥–µ—Ä
kb_builder = ReplyKeyboardBuilder()

# –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤—ã–π —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏
buttons_1: list[KeyboardButton] = [
    KeyboardButton(text=f'–ö–Ω. {i + 1}') for i in range(5)
]
# –°–æ–∑–¥–∞–µ–º –≤—Ç–æ—Ä–æ–π —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏
buttons_2: list[KeyboardButton] = [
    KeyboardButton(text=f'–ö–Ω. {i + 6}') for i in range(10)
]
# –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤ –±–∏–ª–¥–µ—Ä –º–µ—Ç–æ–¥–æ–º row,
# —É–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –≤ –æ–¥–Ω–æ–º —Ä—è–¥—É –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 4 –∫–Ω–æ–ø–∫–∏
kb_builder.row(*buttons_1, width=4)

# –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –≤—Ç–æ—Ä–æ–π —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –º–µ—Ç–æ–¥–æ–º add
kb_builder.add(*buttons_2)


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—É "/start"
# –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ —á–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
@dp.message(CommandStart())
async def process_start_command(message: Message):
    await message.answer(
        text='–í–æ—Ç —Ç–∞–∫–∞—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞',
        reply_markup=kb_builder.as_markup(resize_keyboard=True)
    )
```

##### –ú–µ—Ç–æ–¥ adjust()

–ß—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –∫–∞–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–æ–ø–æ–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –∫–∞–∂–¥–æ–º —Ä—è–¥—É - –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –º–µ—Ç–æ–¥¬†`adjust`¬†—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ (–æ—Ç 1 –¥–æ 8), –Ω–∞—á–∏–Ω–∞—è —Å –ø–µ—Ä–≤–æ–≥–æ —Ä—è–¥–∞. –ü—Ä–∏—á–µ–º –¥–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä¬†`width`, –µ—Å–ª–∏ –∫–Ω–æ–ø–∫–∏ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±–∏–ª–¥–µ—Ä –º–µ—Ç–æ–¥–æ–º¬†`row`.

–°–æ–∑–¥–∞–¥–∏–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É, –¥–æ–±–∞–≤–∏–≤ 8 –∫–Ω–æ–ø–æ–∫ –º–µ—Ç–æ–¥–æ–º¬†`add`¬†–∏ —Ä–∞—Å—Å—Ç–∞–≤–∏–º –∏—Ö —Ç–∞–∫, —á—Ç–æ–±—ã –≤ 1-–º —Ä—è–¥—É –±—ã–ª–∞ –æ–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞, –≤–æ –≤—Ç–æ—Ä–æ–º - 3, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–∞–≤–∏–ª–∏—Å—å –±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∏–ª–¥–µ—Ä
kb_builder = ReplyKeyboardBuilder()

# –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤—ã–π —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏
buttons_1: list[KeyboardButton] = [
    KeyboardButton(text=f'–ö–Ω–æ–ø–∫–∞ {i + 1}') for i in range(8)
]
# –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –º–µ—Ç–æ–¥–æ–º add
kb_builder.add(*buttons_1)

# –Ø–≤–Ω–æ —Å–æ–æ–±—â–∞–µ–º –±–∏–ª–¥–µ—Ä—É —Å–∫–æ–ª—å–∫–æ —Ö–æ—Ç–∏–º –≤–∏–¥–µ—Ç—å –∫–Ω–æ–ø–æ–∫ –≤ 1-–º –∏ 2-–º —Ä—è–¥–∞—Ö
kb_builder.adjust(1, 3)


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—É "/start"
# –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ —á–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
@dp.message(CommandStart())
async def process_start_command(message: Message):
    await message.answer(
        text='–í–æ—Ç —Ç–∞–∫–∞—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞',
        reply_markup=kb_builder.as_markup(resize_keyboard=True)
    )
```


–¢–∞–∫–∂–µ —É –º–µ—Ç–æ–¥–∞¬†`adjust`¬†–µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä¬†`repeat`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–µ–Ω¬†`False`. –ï—Å–ª–∏ —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ¬†`True`, —Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–Ω–æ–ø–æ–∫ –ø–æ —Ä—è–¥–∞–º –±—É–¥—É—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è –¥–ª—è –Ω–æ–≤—ã—Ö —Ä—è–¥–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏.

–°–æ–∑–¥–∞–¥–∏–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å 10 –∫–Ω–æ–ø–∫–∞–º–∏, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º–∏ –≤ –±–∏–ª–¥–µ—Ä –º–µ—Ç–æ–¥–æ–º¬†`add`¬†–∏ –º–µ—Ç–æ–¥–æ–º¬†`adjust`¬†—Ä–∞–∑–º–µ—Å—Ç–∏–º –∏—Ö –ø–æ –¥–≤–µ –≤ –∫–∞–∂–¥–æ–º –Ω–µ—á–µ—Ç–Ω–æ–º —Ä—è–¥—É –∏ –ø–æ 1 –≤ –∫–∞–∂–¥–æ–º —á–µ—Ç–Ω–æ–º.

```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∏–ª–¥–µ—Ä
kb_builder = ReplyKeyboardBuilder()

# –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤—ã–π —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏
buttons_1: list[KeyboardButton] = [
    KeyboardButton(text=f'–ö–Ω–æ–ø–∫–∞ {i + 1}') for i in range(10)
]
# –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –º–µ—Ç–æ–¥–æ–º add
kb_builder.add(*buttons_1)

# –Ø–≤–Ω–æ —Å–æ–æ–±—â–∞–µ–º –±–∏–ª–¥–µ—Ä—É —Å–∫–æ–ª—å–∫–æ —Ö–æ—Ç–∏–º –≤–∏–¥–µ—Ç—å –∫–Ω–æ–ø–æ–∫ –≤ 1-–º –∏ 2-–º —Ä—è–¥–∞—Ö,
# –∞ —Ç–∞–∫–∂–µ –≥–æ–≤–æ—Ä–∏–º –º–µ—Ç–æ–¥—É –ø–æ–≤—Ç–æ—Ä—è—Ç—å —Ç–∞–∫–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ä—è–¥–æ–≤
kb_builder.adjust(2, 1, repeat=True)


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—É "/start"
# –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ —á–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
@dp.message(CommandStart())
async def process_start_command(message: Message):
    await message.answer(
        text='–í–æ—Ç —Ç–∞–∫–∞—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞',
        reply_markup=kb_builder.as_markup(resize_keyboard=True)
    )
```

## –ú–µ—Ç–æ–¥ as_markup()

–ú–µ—Ç–æ–¥¬†`as_markup`¬†–ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –±–∏–ª–¥–µ—Ä –≤ –æ–±—ä–µ–∫—Ç¬†`ReplyKeyboardMarkup`, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–º—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä—É—é –º—ã –≤ –±–∏–ª–¥–µ—Ä–µ –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ –∫–∞–∫¬†–º–∞—Å—Å–∏–≤ –º–∞—Å—Å–∏–≤–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏, –∞ —Ç–∞–∫–∂–µ –¥—Ä—É–≥–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.

https://core.telegram.org/bots/api#replykeyboardmarkup

## –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ–±—ã—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏

–°—É—â–µ—Å—Ç–≤—É–µ—Ç 6 —Ç–∏–ø–æ–≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–±—ã—á–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫:

- –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–≤–æ–µ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–ø–∞—Ä–∞–º–µ—Ç—Ä¬†`request_contact`)
- –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–≤–æ–µ–π –≥–µ–æ–ø–æ–∑–∏—Ü–∏–∏ (–ø–∞—Ä–∞–º–µ—Ç—Ä¬†`request_location`)
- –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–∞/–≤–∏–∫—Ç–æ—Ä–∏–Ω—ã (–ø–∞—Ä–∞–º–µ—Ç—Ä¬†`request_poll`)
- –î–ª—è –∑–∞–ø—É—Å–∫–∞ Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –ø—Ä—è–º–æ –≤ –¢–µ–ª–µ–≥—Ä–∞–º (–ø–∞—Ä–∞–º–µ—Ç—Ä¬†`web_app`)
- (–ø–∞—Ä–∞–º–µ—Ç—Ä¬†`request_user`)
- (–ø–∞—Ä–∞–º–µ—Ç—Ä¬†`request_chat`)

## –ò–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏

–ó–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–æ–∫ –æ—Ç–≤–µ—á–∞—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∞—Å—Å—ã –∏–∑¬†`aiogram.types`:

- `InlineKeyboardMarkup`¬†- –æ–±—ä–µ–∫—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫¬†—Ä—è–¥–æ–≤ –∫–Ω–æ–ø–æ–∫ (–æ–±—ä–µ–∫—Ç–æ–≤¬†`InlineKeyboardButton`)
- `InlineKeyboardButton`¬†- –æ–±—ä–µ–∫—Ç –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏

–ö–Ω–æ–ø–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏¬†`aiogram_calendar`: 

![[aiogram_calendar.avif]]
##### URL-–∫–Ω–æ–ø–∫–∏

URL-–∫–Ω–æ–ø–∫–∏ - —ç—Ç–æ —Ç–∞–∫–∏–µ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏, –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –Ω–∞—Å –≤ –±—Ä–∞—É–∑–µ—Ä –ø–æ —Å—Å—ã–ª–∫–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å —ç—Ç–æ–π –∫–Ω–æ–ø–∫–æ–π, –∏–ª–∏ –Ω–∞ –∫–∞–∫–æ–π-—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä–µ—Å—É—Ä—Å —Å–∞–º–æ–≥–æ –¢–µ–ª–µ–≥—Ä–∞–º (–∫–∞–Ω–∞–ª, –≥—Ä—É–ø–ø—É –∏ —Ç.–ø.) —Ç–æ–∂–µ –ø–æ —Å—Å—ã–ª–∫–µ. –ó–∞ –Ω–∏—Ö –æ—Ç–≤–µ—á–∞–µ—Ç –∞—Ç—Ä–∏–±—É—Ç¬†`url`¬†–∫–ª–∞—Å—Å–∞¬†`InlineKeyboardButton`. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —Ç–∞–∫–∏–µ –∫–Ω–æ–ø–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç.

```python
# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç—ã –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–æ–∫
url_button_1 = InlineKeyboardButton(
    text='–ö—É—Ä—Å "–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç—ã –Ω–∞ Python –∏ AIOgram"',
    url='https://stepik.org/120924'
)
url_button_2 = InlineKeyboardButton(
    text='–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Telegram Bot API',
    url='https://core.telegram.org/bots/api'
)

# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
keyboard = InlineKeyboardMarkup(
    inline_keyboard=[[url_button_1],
                     [url_button_2]]
)


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—É "/start"
# –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ —á–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É c url-–∫–Ω–æ–ø–∫–∞–º–∏
@dp.message(CommandStart())
async def process_start_command(message: Message):
    await message.answer(
        text='–≠—Ç–æ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º "url"',
        reply_markup=keyboard
    )
```

##### Callback-–∫–Ω–æ–ø–∫–∏

```python
# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç—ã –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–æ–∫
big_button_1 = InlineKeyboardButton(
    text='–ë–û–õ–¨–®–ê–Ø –ö–ù–û–ü–ö–ê 1',
    callback_data='big_button_1_pressed'
)

big_button_2 = InlineKeyboardButton(
    text='–ë–û–õ–¨–®–ê–Ø –ö–ù–û–ü–ö–ê 2',
    callback_data='big_button_2_pressed'
)

# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
keyboard = InlineKeyboardMarkup(
    inline_keyboard=[[big_button_1],
                     [big_button_2]]
)


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—É "/start"
# –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ —á–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∞–º–∏
@dp.message(CommandStart())
async def process_start_command(message: Message):
    await message.answer(
        text='–≠—Ç–æ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏. –ù–∞–∂–º–∏ –Ω–∞ –ª—é–±—É—é!',
        reply_markup=keyboard
)
```

```python
from aiogram import F
from aiogram.types import CallbackQuery

# ...

# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∞–ø–¥–µ–π—Ç —Ç–∏–ø–∞ CallbackQuery
# —Å data 'big_button_1_pressed' –∏–ª–∏ 'big_button_2_pressed'
@dp.callback_query(F.data.in_(['big_button_1_pressed',
                               'big_button_2_pressed']))
async def process_buttons_press(callback: CallbackQuery):
    await callback.answer()

# ...
```

–°—á–∏—Ç–∞–µ—Ç—Å—è —Ö–æ—Ä–æ—à–∏–º —Ç–æ–Ω–æ–º –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∫–∞–∂–¥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ callback-–∫–Ω–æ–ø–∫–∏, —á—Ç–æ–±—ã –±–æ—Ç –Ω–µ "–∑–∞–≤–∏—Å–∞–ª –≤ –∑–∞–¥—É–º—á–∏–≤–æ—Å—Ç–∏". –î–ª—è —ç—Ç–æ–≥–æ, –∫–∞–∫ –≤ –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤ –∫–æ–Ω—Ü–µ —Ö—ç–Ω–¥–ª–µ—Ä–∞ –≤—ã–∑—ã–≤–∞—Ç—å¬†`callback.answer()`, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–∏–∫–∞–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è.

```python
# ...

# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∞–ø–¥–µ–π—Ç —Ç–∏–ø–∞ CallbackQuery
# —Å data 'big_button_1_pressed'
@dp.callback_query(F.data == 'big_button_1_pressed')
async def process_button_1_press(callback: CallbackQuery):
    if callback.message.text != '–ë—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –ë–û–õ–¨–®–ê–Ø –ö–ù–û–ü–ö–ê 1':
        await callback.message.edit_text(
            text='–ë—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –ë–û–õ–¨–®–ê–Ø –ö–ù–û–ü–ö–ê 1',
            reply_markup=callback.message.reply_markup
        )
    await callback.answer()


# –≠—Ç–æ—Ç —Ö—ç–Ω–¥–ª–µ—Ä –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∞–ø–¥–µ–π—Ç —Ç–∏–ø–∞ CallbackQuery
# —Å data 'big_button_2_pressed'
@dp.callback_query(F.data == 'big_button_2_pressed')
async def process_button_2_press(callback: CallbackQuery):
    if callback.message.text != '–ë—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –ë–û–õ–¨–®–ê–Ø –ö–ù–û–ü–ö–ê 2':
        await callback.message.edit_text(
            text='–ë—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –ë–û–õ–¨–®–ê–Ø –ö–ù–û–ü–ö–ê 2',
            reply_markup=callback.message.reply_markup
        )
    await callback.answer()

#...
```

##### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã —Å –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∞–º–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º¬†`callback_data`:

1. –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ —Å —Ç–µ–∫—Å—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–∞ –∫–Ω–æ–ø–∫–µ, –∏ —Ç–µ–∫—Å—Ç–æ–º –≤¬†`callback_data`, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –≤ –∞–ø–¥–µ–π—Ç–µ —Ç–∏–ø–∞¬†`CallbackQuery`¬†–≤ –ø–æ–ª–µ¬†`data`.
2. –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–µ–≥–æ –º–∞—Å—Å–∏–≤ –º–∞—Å—Å–∏–≤–æ–≤ –∫–Ω–æ–ø–æ–∫.
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É¬†–≤–º–µ—Å—Ç–µ —Å —Ç–µ–∫—Å—Ç–æ–º —Å–æ–æ–±—â–µ–Ω–∏—è¬†–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (–ø–∞—Ä–∞–º–µ—Ç—Ä¬†`reply_markup`).
4. –ú–µ—Ç–æ–¥–æ–º¬†`callback_query`¬†—É –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ (—Ä–æ—É—Ç–µ—Ä–∞) –ª–æ–≤–∏–º –∞–ø–¥–µ–π—Ç —Ç–∏–ø–∞¬†`CallbackQuery`, —Ñ–∏–ª—å—Ç—Ä—É–µ–º¬†–µ–≥–æ –ø–æ –ø–æ–ª—é¬†`data`¬†–∏ –Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ö—ç–Ω–¥–ª–µ—Ä.
5. –í —Ö—ç–Ω–¥–ª–µ—Ä–µ –ª–∏–±–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ (—Ç–µ–∫—Å—Ç –∏/–∏–ª–∏¬†–∫–Ω–æ–ø–∫–∏), –ª–∏–±–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç¬†`callback.answer()`, —á—Ç–æ–±—ã —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –±—ã–ª–æ –æ—â—É—â–µ–Ω–∏—è, —á—Ç–æ –±–æ—Ç –∑–∞–≤–∏—Å –≤ –∑–∞–¥—É–º—á–∏–≤–æ—Å—Ç–∏.
6. –ü–æ–≤—Ç–æ—Ä—è–µ–º —Å–Ω–∞—á–∞–ª–∞ - —Å—Ç–æ–ª—å–∫–æ —Ä–∞–∑, —Å–∫–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.
##### `callback.answer()`–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- `text`¬†- –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ç–µ–∫—Å—Ç –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ –Ω–∞ –ø–∞—Ä—É —Å–µ–∫—É–Ω–¥ –æ–∫–Ω–∞ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ –∞–ª–µ—Ä—Ç–∞ (–¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤)
- `show_alert`¬†- –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ –∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏—Å—á–µ–∑–∞—é—â–µ–≥–æ¬†–æ–∫–æ—à–∫–∞ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –∞–ª–µ—Ä—Ç, —Ç—Ä–µ–±—É—é—â–∏–π –∑–∞–∫—Ä—ã—Ç–∏—è,¬†–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–≤–Ω—ã–º¬†`True`. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é -¬†`False`.
- `url`¬†- —Å—Å—ã–ª–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∞ –∫–ª–∏–µ–Ω—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–µ –ª—é–±—ã–µ —Å—Å—ã–ª–∫–∏, –∞ —Ç–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ)
- `cache_time`¬†- –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)¬†–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∫–ª–∏–µ–Ω—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
## InlineKeyboardBuilder ("—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä")

1. –í —Ä–∞–º–∫–∞—Ö –∫–ª–∞—Å—Å–∞ –¥–æ—Å—Ç—É–ø–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
    
    - `row()`¬†- –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –±–∏–ª–¥–µ—Ä¬†—Å–ø–∏—Å–∫–∞ –∫–Ω–æ–ø–æ–∫. –ü–∞—Ä–∞–º–µ—Ç—Ä¬†`width`¬†–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ç–æ, —Å–∫–æ–ª—å–∫–æ –∫–Ω–æ–ø–æ–∫ –±—É–¥–µ—Ç –≤ –æ–¥–Ω–æ–º —Ä—è–¥—É, –∫–æ–≥–¥–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
        
    - `add()`¬†- —ç—Ç–∏–º –º–µ—Ç–æ–¥–æ–º –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä—è–¥ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, –µ—Å–ª–∏ –∏—Ö —Ç–∞–º –µ—â–µ –º–µ–Ω—å—à–µ 8. –ï—Å–ª–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Ä—è–¥—É —É–∂–µ –∏—Ç–∞–∫ 8 –∫–Ω–æ–ø–æ–∫ - –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –Ω–æ–≤—ã–π —Ä—è–¥. –ú–µ—Ç–æ–¥¬†`add()`¬†–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä¬†`width`¬†–º–µ—Ç–æ–¥–∞¬†`row()`, –µ—Å–ª–∏ –æ–Ω –≤—ã–∑—ã–≤–∞–ª—Å—è —Ä–∞–Ω–µ–µ. –¢–æ –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥—É –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–æ 8, –Ω–µ –∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ. —á—Ç–æ —É–∫–∞–∑–∞–Ω–æ –≤¬†`width`¬†–º–µ—Ç–æ–¥–∞¬†`row()`
        
    - `adjust()`¬†- –º–µ—Ç–æ–¥, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –∫–Ω–æ–ø–∫–∏, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–æ–º¬†`row()`, –≤ –∫–∞—Å—Ç–æ–º–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ú–µ—Ç–æ–¥¬†–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä¬†`width`¬†–º–µ—Ç–æ–¥–∞¬†`row()`
        
    - `copy()`¬†- –º–µ—Ç–æ–¥, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é –∫–æ–ø–∏—é –±–∏–ª–¥–µ—Ä–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ö–æ–∂—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É, –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–≤ —Å—Ç–∞—Ä—É—é, –Ω–æ –Ω–µ –º–µ–Ω—è—è¬†—Å–∞–º—É —Å—Ç–∞—Ä—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
        
    - `export()`¬†- –º–µ—Ç–æ–¥, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –∏–∑ –±–∏–ª–¥–µ—Ä–∞
        
    - `as_markup()`¬†- –º–µ—Ç–æ–¥, –ø—Ä–µ–≤—Ä–∞—â–∞—é—â–∏–π –±–∏–ª–¥–µ—Ä –≤ –æ–±—ä–µ–∫—Ç –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã¬†`InlineKeyboardMarkup`

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–±—Ä–∏–∫–æ–π –∫–æ–ª–ª–±—ç–∫–æ–≤

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ñ–∞–±—Ä–∏–∫–æ–π –∫–æ–ª–ª–±—ç–∫–æ–≤ –Ω—É–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –≤ –≥–æ–ª–æ–≤–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏/–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

1. –î–ª–∏–Ω–∞¬†`callback_data`¬†–¥–ª—è –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–æ–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ 64 –±–∞–π—Ç–∞–º–∏. –≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ, –Ω–æ –≤ —Ü–µ–ª–æ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–Ω–æ–≥–∏—Ö –∑–∞–¥—É–º–æ–∫.
2. –í –∫–∞—á–µ—Å—Ç–≤–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è¬†–¥–∞–Ω–Ω—ã—Ö –≤¬†`callback_data`,¬†–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤–æ–µ—Ç–æ—á–∏–µ. –ù–æ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π —Å–∏–º–≤–æ–ª –∏–ª–∏ –≥—Ä—É–ø–ø—É —Å–∏–º–≤–æ–ª–æ–≤. –ó–∞ —ç—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä¬†`sep`. –ò–º–µ–µ—Ç —Å–º—ã—Å–ª –º–µ–Ω—è—Ç—å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —É –≤–∞—Å –º–æ–≥—É—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –¥–≤–æ–µ—Ç–æ—á–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã —Å—Ç—Ä–æ–∏—Ç–µ¬†`callback_data`.
3. –ï—Å–ª–∏ –≤—ã —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç–µ –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∫–∞–∫ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ –∫–Ω–æ–ø–æ–∫, —Ç–æ —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ –≤–∞—à–µ–π —Ñ–∞–±—Ä–∏–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–ø–∞–∫–æ–≤–∞—Ç—å –≤ —Å—Ç—Ä–æ–∫—É —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞¬†`pack()`.
4. –ï—Å–ª–∏ –≤—ã —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç–µ –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –ø–æ–º–æ—â—å—é –±–∏–ª–¥–µ—Ä–∞, –¥–æ–±–∞–≤–ª—è—è –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –º–µ—Ç–æ–¥¬†`button()`¬†- —É–ø–∞–∫–æ–≤—ã–≤–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ —Ñ–∞–±—Ä–∏–∫–∏ –≤ —Å—Ç—Ä–æ–∫—É –Ω–µ –Ω–∞–¥–æ.
5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–∑–∞—â–∏—â–µ–Ω–Ω–æ–π —Ñ–∞–±—Ä–∏–∫–∏ –∫–æ–ª–ª–±—ç–∫–æ–≤ - —ç—Ç–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–æ–¥–º–µ–Ω—è—Ç—å¬†`callback_data`, –æ—Ç–ø—Ä–∞–≤–ª—è—è –≤–∞—à–µ–º—É –±–æ—Ç—É –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞ —Ç–µ–ª–µ–≥—Ä–∞–º —Å –¥–∞–Ω–Ω—ã–º–∏ –∫–Ω–æ–ø–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏.

## Middleware

**Middleware**¬†- —ç—Ç–æ –æ—Ç —Å–ª–æ–≤¬†_middle_¬†(—Å–µ—Ä–µ–¥–∏–Ω–∞) –∏¬†_ware_¬†(–∏–∑–¥–µ–ª–∏–µ). –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ IT - —ç—Ç–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ. –ö–∞–∫–æ–π-—Ç–æ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª–∏–Ω–∏–≤–∞–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (–ø–∞–π–ø–ª–∞–π–Ω). –° —Ü–µ–ª—å—é –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏—Ö, –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç.–ø.

##### Middleware –∫–∞–∫ –∫–ª–∞—Å—Å

```python
from typing import Any, Awaitable, Callable, Dict

from aiogram import BaseMiddleware
from aiogram.types import TelegramObject


class SomeMiddleware(BaseMiddleware):
    async def __call__(
        self,
        handler: Callable[[TelegramObject, Dict[str, Any]], Awaitable[Any]],
        event: TelegramObject,
        data: Dict[str, Any]
    ) -> Any:

        # ...
        # –ó–¥–µ—Å—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–¥ –Ω–∞ –≤—Ö–æ–¥–µ –≤ middleware
        # ...

        result = await handler(event, data)

        # ...
        # –ó–¥–µ—Å—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–¥ –Ω–∞ –≤—ã—Ö–æ–¥–µ –∏–∑ middleware
        # ...

        return result
```

¬†**–í–∞–∂–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–∏–¥–¥–ª–≤–∞—Ä–∏ –¥–æ–ª–∂–Ω—ã –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –æ—Ç –∫–ª–∞—Å—Å–∞¬†`BaseMiddleware`.
- –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –º–∏–¥–¥–ª–≤–∞—Ä–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥¬†`__call__`.
- –ú–µ—Ç–æ–¥¬†`__call__`¬†–≤—Å–µ–≥–¥–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 4 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–∞:
    - `self`¬†- —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞. –≠—Ç–æ –û–û–ü, –¥—Ä—É–∑—å—è.
    - `handler`¬†- –æ–±—ä–µ–∫—Ç —Ö—ç–Ω–¥–ª–µ—Ä–∞. –î–ª—è outer middleware –æ–Ω –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä—ã –º—ã –Ω–µ –∑–Ω–∞–µ–º –µ—Å—Ç—å –ª–∏ –≤–æ–æ–±—â–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∞–ø–¥–µ–π—Ç–∞ —Ö—ç–Ω–¥–ª–µ—Ä.
    - `event`¬†-¬†`TelegramObject`¬†- —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è, –∫–æ—Ç–æ—Ä–æ–µ¬†—Ö–æ—Ç–∏–º –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å (`Update`,¬†`Message`,¬†`CallbackQuery`...).
    - `data`¬†- —Å–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏, –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å —Ç–µ–∫—É—â–∏–º –∞–ø–¥–µ–π—Ç–æ–º.

–î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–∏–¥–¥–ª–≤–∞—Ä–µ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:
```
<–∏–º—è_—Ä–æ—É—Ç–µ—Ä–∞>.<—Ç–∏–ø_—Å–æ–±—ã—Ç–∏—è>.<—Ç–∏–ø_–º–∏–¥–¥–ª–≤–∞—Ä–∏>(<–∏–º—è_–º–∏–¥–¥–ª–≤–∞—Ä–∏>())
```

**–ü—Ä–∏–º–µ—Ä 1.**¬†–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –≤–Ω–µ—à–Ω—é—é –º–∏–¥–¥–ª–≤–∞—Ä—å, –≤ –∫–æ—Ç–æ—Ä—É—é –±—É–¥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å –≤—Å–µ –∞–ø–¥–µ–π—Ç—ã.

```python
dp.update.outer_middleware(SomeOuterMiddleware())
dp.update.middleware(SomeOuterMiddleware())
```
**–ü—Ä–∏–º–µ—Ä 2.**¬†–ü–æ–¥–∫–ª—é—á–∞–µ–º –≤–Ω–µ—à–Ω—é—é –º–∏–¥–¥–ª–≤–∞—Ä—å –∫ –∫–æ—Ä–Ω–µ–≤–æ–º—É —Ä–æ—É—Ç–µ—Ä—É –¥–ª—è —Å–æ–±—ã—Ç–∏–π —Ç–∏–ø–∞¬†`Message`.

```python
dp.message.outer_middleware(SomeOuterMiddleware())
```

**–ü—Ä–∏–º–µ—Ä 3.**¬†–ü–æ–¥–∫–ª—é—á–∞–µ–º –∫ —Ä–æ—É—Ç–µ—Ä—É¬†`some_router`¬†–≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –º–∏–¥–¥–ª–≤–∞—Ä—å –Ω–∞ –∞–ø–¥–µ–π—Ç—ã —Ç–∏–ø–∞¬†`CallbackQuery`.

```python
some_router.callback_query.middleware(SomeInnerMiddleware())
```

**–ü—Ä–∏–º–µ—Ä 4.**¬†–ü–æ–¥–∫–ª—é—á–∞–µ–º –≤–Ω–µ—à–Ω—é—é –º–∏–¥–¥–ª–≤–∞—Ä—å –∫ –¥–∏—Å–ø–µ—Ç—á–µ—Ä—É –Ω–∞ —Å–æ–±—ã—Ç–∏—è —Ç–∏–ø–∞¬†`CallbackQuery`, –∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –Ω–∞ —Å–æ–±—ã—Ç–∏—è —Ç–∏–ø–∞¬†`Message`¬†–∫ —Ä–æ—É—Ç–µ—Ä—É¬†`some_router`.

```python
dp.callback_query.outer_middleware(SomeOuterMiddleware()) some_router.message.middleware(SomeInnerMiddleware())
```

##### –¢–∏–ø–æ–≤—ã–µ –∑–∞–¥–∞—á–∏, —Ä–µ—à–∞–µ–º—ã–µ –º–∏–¥–¥–ª–≤–∞—Ä—è–º–∏
1. –û–±—Ä–∞—â–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –¢–µ–Ω–µ–≤–æ–π –±–∞–Ω
```python
from typing import Any, Awaitable, Callable, Dict

from aiogram import BaseMiddleware
from aiogram.types import TelegramObject, User

CACHE = {
    'banned': [254443334, 214454432, 112221212],
}


class ShadowBanMiddleware(BaseMiddleware):

    async def __call__(
        self,
        handler: Callable[[TelegramObject, Dict[str, Any]], Awaitable[Any]],
        event: TelegramObject,
        data: Dict[str, Any]
    ) -> Any:
        
        user: User = data.get('event_from_user')
        if user is not None:
            if user.id in CACHE.get('banned'):
                return

        return await handler(event, data)
```

```python
dp.update.middleware(ShadowBanMiddleware())
```
1. –ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω–Ω–µ–∫—Ç–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Ö—ç–Ω–¥–ª–µ—Ä—ã
2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –ó–∞–º–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–∑–∫–∏—Ö –º–µ—Å—Ç
5. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
6. –¢—Ä–æ—Ç—Ç–ª–∏–Ω–≥
```python
from typing import Any, Awaitable, Callable, Dict

from aiogram import BaseMiddleware
from aiogram.types import TelegramObject, User
from cachetools import TTLCache

CACHE = TTLCache(maxsize=10_000, ttl=5)  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞ - 10000 –∫–ª—é—á–µ–π, –∞ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–ª—é—á–∞ - 5 —Å–µ–∫—É–Ω–¥

class ThrottlingMiddleware(BaseMiddleware):

    async def __call__(
            self,
            handler: Callable[[TelegramObject, Dict[str, Any]], Awaitable[Any]],
            event: TelegramObject,
            data: Dict[str, Any],
    ) -> Any:
        user: User = data.get('event_from_user')

        if user.id in CACHE:
            return

        CACHE[user.id] = True

        return await handler(event, data)
```

```python
dp.update.middleware(ThrottlingMiddleware())
```
